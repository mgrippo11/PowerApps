scr_MiReserva As screen:
    Fill: =RGBA(0, 0, 0, 0)
    OnVisible: =Refresh(Mesas_1); Refresh(Reservas)

    img_fondo_2 As image:
        Height: =768
        Image: ='subtle-prism (1)'
        ImagePosition: =ImagePosition.Fill
        Transparency: =0.3
        Visible: =false
        Width: =1366
        ZIndex: =1

    lbl_fondo_3 As label:
        Fill: |-
            =If(First(var_Evento).Tipo_Color = "HEX", 
                ColorValue(First(var_Evento).Color)
            , 
                RGBA(First(FirstN(Split(First(var_Evento).Color, ";"), 2)).Value,Last(FirstN(Split(First(var_Evento).Color, ";"), 2)).Value,Last(FirstN(Split(First(var_Evento).Color, ";"), 3)).Value, 1))
        Height: =768
        Text: =""
        Width: =1366
        ZIndex: =2

    lbl_titulo_mireserva As label:
        Align: =Align.Center
        FontWeight: =FontWeight.Bold
        Height: =45
        Size: =20
        Text: ="Mi Reserva"
        Width: =1366
        Y: =75
        ZIndex: =3

    th_perfil_titular_1 As htmlViewer:
        Height: =156
        HtmlText: |-
            ="<div style=""margin: 0px; width: "&(Self.Width-13)&"px; height: "&(Self.Height-13)&"px; background-color: rgba(255,255,255,0.5); box-shadow: 2px 2px 2px 0px rgba(0,0,0,0.2); border-radius:5px""></div>"
        Width: =578
        X: =24
        Y: =129
        ZIndex: =4

    th_detalle_mesa As htmlViewer:
        Height: =155
        HtmlText: |-
            ="<div style=""margin: 0px; width: "&(Self.Width-13)&"px; height: "&(Self.Height-13)&"px; background-color: rgba(255,255,255,0.5); box-shadow: 2px 2px 2px 0px rgba(0,0,0,0.2); border-radius:5px""></div>"
        Width: =678
        X: =656
        Y: =130
        ZIndex: =5

    lbl_numero_mesa_2 As label:
        FontWeight: =FontWeight.Bold
        Height: =50
        Size: =18
        Text: |-
            ="Número Mesa Reservada: " & First(Filter(Mesas_1, var_reserva.Id_Mesa = ID)).Numero_Mesa
        Visible: =(First(var_Evento).Estado.Value = "Activo" ||  First(var_Evento).Estado.Value = "Finalizado") && var_reserva.Mail <> Blank() && var_reserva.Id_Mesa <> 0
        Width: =394
        X: =682
        Y: =158
        ZIndex: =6

    icn_perfil_9 As icon.Person:
        Height: =100
        Icon: =Icon.Person
        OnSelect: =
        Width: =100
        X: =50
        Y: =153
        ZIndex: =7

    gp_titular_1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =10

        lbl_nombre_titular_1 As label:
            FontWeight: =FontWeight.Bold
            Height: =30
            Text: ="Nombre"
            Width: =112
            X: =166
            Y: =143
            ZIndex: =8

        txt_nombre_titular_1 As text:
            Default: |-
                =//User().FullName
                First(Filter(Reservas, var_reserva.Id_Mesa = Id_Mesa, Id_Evento = var_idEvento, Titular = true)).NombreCompleto
            DisplayMode: =DisplayMode.View
            Height: =30
            Width: =411
            X: =166
            Y: =173
            ZIndex: =9

        txt_mail_titular_1 As text:
            Default: =User().Email
            DisplayMode: =DisplayMode.View
            Height: =30
            Visible: =false
            Width: =365
            X: =166
            Y: =233
            ZIndex: =10

        lbl_acompañante_titular As label:
            FontWeight: =FontWeight.Bold
            Height: =30
            Text: |
                =//If(!IsBlank(var_reserva); "Acompañante: " & var_reserva.NombreInvitado; "Sin acompañante")
                If(!IsBlank(First(Filter(Reservas, var_reserva.Id_Mesa = Id_Mesa, Id_Evento = var_idEvento, Titular = true)).NombreInvitado), 
                    "Acompañante: " &First(Filter(Reservas, var_reserva.Id_Mesa = Id_Mesa, Id_Evento = var_idEvento, Titular = true)).NombreInvitado
                , 
                    "Sin acompañante"
                )
            Width: =411
            X: =166
            Y: =203
            ZIndex: =11

        img_titular_1 As image:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderThickness: =2
            Image: |-
                =//User().Image
                If(CountRows(UsuariosdeOffice365.SearchUser({searchTerm: First(Filter(Reservas, var_reserva.Id_Mesa = Id_Mesa, Id_Evento = var_idEvento, Titular = true)).Mail, top: 15})) > 0,
                    If(!IsBlank(First(Filter(Reservas, var_reserva.Id_Mesa = Id_Mesa, Id_Evento = var_idEvento, Titular = true)).Mail), UsuariosdeOffice365.UserPhotoV2(First(Filter(Reservas, var_reserva.Id_Mesa = Id_Mesa, Id_Evento = var_idEvento, Titular = true)).Mail))
                )
            X: =48
            Y: =153
            ZIndex: =12

    th_invitados As htmlViewer:
        Height: =387
        HtmlText: |-
            ="<div style=""margin: 0px; width: "&(Self.Width-13)&"px; height: "&(Self.Height-13)&"px; background-color: rgba(255,255,255,0.5); box-shadow: 2px 2px 2px 0px rgba(0,0,0,0.2); border-radius:5px""></div>"
        Width: =1310
        X: =24
        Y: =309
        ZIndex: =13

    "gal_invitados_1 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
        DelayItemLoading: =true
        DisplayMode: =DisplayMode.View
        Height: =338
        Items: =Filter(Reservas, var_reserva.Id_Mesa = Id_Mesa, Id_Evento = var_idEvento, Titular = false)
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        TemplatePadding: =0
        TemplateSize: =99
        Visible: |-
            =//(First(var_Evento).Estado.Value = "Activo" ||  First(var_Evento).Estado.Value = "Finalizado") && 
            var_reserva.Mail <> Blank() && var_reserva.Id_Mesa <> 0
            
            //&& Now() > First(var_Evento).FechaFinalizacion
        Width: =1255
        X: =48
        Y: =331
        ZIndex: =14

        lbl_titulo_nombre As label:
            FontWeight: =FontWeight.Bold
            Height: =35
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =17
            Text: |-
                ="Nombre:" 
            Width: =109
            X: =99
            Y: =11
            ZIndex: =1

        lbl_acompañante_3 As label:
            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
            Height: =30
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =16
            Text: |-
                =If(ThisItem.Invitado, "Acompañante: " & ThisItem.NombreInvitado, "Sin acompañante")
            Visible: |-
                =//ThisItem.Invitado
                true
            Width: =519
            X: =99
            Y: =49
            ZIndex: =2

        Separator1_1 As rectangle:
            Height: =6
            OnSelect: =Select(Parent)
            Width: =Parent.TemplateWidth
            Y: =91
            ZIndex: =4

        Rectangle4_1 As rectangle:
            Height: =Parent.TemplateHeight - Separator1_1.Height
            OnSelect: =Select(Parent)
            Visible: =ThisItem.IsSelected
            Width: =4
            ZIndex: =5

        lbl_nombre_invitado As label:
            FontWeight: =FontWeight.Bold
            Height: =35
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =17
            Text: =If(IsBlank(ThisItem.'Nombre (field_4)'), ThisItem.NombreCompleto, ThisItem.'Nombre (field_4)' & " " & ThisItem.Apellido)
            Width: =577
            X: =208
            Y: =11
            ZIndex: =7

        icn_perfil_2 As icon.Person:
            Height: =50
            Icon: =Icon.Person
            OnSelect: =Select(Parent)
            Width: =50
            X: =27
            Y: =22
            ZIndex: =8

        img_foto_perfil_1 As image:
            Height: =72
            Image: |-
                =//If(!IsBlank(ThisItem.Título); UsuariosdeOffice365.UserPhotoV2(ThisItem.Título))
                
                If(CountRows(UsuariosdeOffice365.SearchUser({searchTerm: ThisItem.Mail, top: 15})) > 0,
                    If(!IsBlank(ThisItem.Mail), UsuariosdeOffice365.UserPhotoV2(ThisItem.Mail))
                )
            OnSelect: =Select(Parent)
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Width: =72
            X: =16
            Y: =11
            ZIndex: =9

        lbl_estacionamiento_1 As label:
            FontWeight: =FontWeight.Semibold
            Height: =30
            PaddingLeft: =20
            Text: |-
                ="Estacionamiento: "& If(ThisItem.Estacionamiento, "Confirmado", "Sin confirmar")
            Width: =361
            X: =618
            Y: =49
            ZIndex: =10

    lbl_cantidad_integrantes As label:
        FontWeight: =FontWeight.Bold
        Height: =50
        Size: =18
        Text: |-
            ="Cantidad de integrantes: " & CountRows(gal_invitados_1.AllItems) + 1 + CountRows(gal_acompañantes_1.AllItems)
        Visible: =(First(var_Evento).Estado.Value = "Activo" ||  First(var_Evento).Estado.Value = "Finalizado") && var_reserva.Mail <> Blank() && var_reserva.Id_Mesa <> 0
        Width: =394
        X: =682
        Y: =213
        ZIndex: =15

    btn_solicitar_modificacion As button:
        Height: =47
        OnSelect: =Set(var_enviarModificacion,true)
        Text: ="Solicitar Modificación"
        Visible: =!IsBlank(var_reserva.Mail) && var_reserva.Titular && First(var_Evento).Estado.Value = "Activo"
        Width: =237
        X: =1090
        Y: =708
        ZIndex: =16

    img_banner_3 As image:
        Height: =75
        Image: =First(var_Evento).Banner1.Full
        ImagePosition: =ImagePosition.Fill
        Width: =1366
        ZIndex: =17

    "gal_acompañantes_1 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
        DelayItemLoading: =true
        DisplayMode: =DisplayMode.View
        Height: =60
        Items: =Filter(Reservas , var_reserva.Id_Mesa = Id_Mesa, Id_Evento = var_idEvento, Invitado = true )
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        TemplatePadding: =0
        TemplateSize: =104
        Visible: =false
        Width: =105
        Y: =708
        ZIndex: =18

        Title1_10 As label:
            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
            Height: =25
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: |-
                ="Empleado TotalEnergies: " & ThisItem.'Nombre (field_4)' & " " & ThisItem.Apellido
            VerticalAlign: =VerticalAlign.Top
            Width: =281
            X: =99
            Y: =2
            ZIndex: =2

        Subtitle1_5 As label:
            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
            Height: =21
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =13
            Text: |-
                ="Acompañante: " & ThisItem.NombreInvitado
            VerticalAlign: =VerticalAlign.Top
            Visible: =ThisItem.Invitado
            Width: =348
            X: =99
            Y: =34
            ZIndex: =3

        NextArrow1_2 As icon.ChevronRight:
            AccessibleLabel: =Self.Tooltip
            Color: =RGBA(166, 166, 166, 1)
            Height: =50
            Icon: =Icon.ChevronRight
            OnSelect: =Select(Parent)
            PaddingBottom: =16
            PaddingLeft: =16
            PaddingRight: =16
            PaddingTop: =16
            Tooltip: ="Ver los detalles del elemento"
            Width: =50
            X: =Parent.TemplateWidth - Self.Width - 12
            Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
            ZIndex: =4

        Separator1_5 As rectangle:
            Height: =8
            OnSelect: =Select(Parent)
            Width: =Parent.TemplateWidth
            Y: =Parent.TemplateHeight - Self.Height
            ZIndex: =5

        Rectangle4_5 As rectangle:
            Height: =Parent.TemplateHeight - Separator1_5.Height
            OnSelect: =Select(Parent)
            Visible: =ThisItem.IsSelected
            Width: =4
            ZIndex: =6

        Checkbox1_4 As checkbox:
            CheckboxSize: =20
            Default: =ThisItem.Estacionamiento
            DisplayMode: =DisplayMode.View
            Height: =25
            OnSelect: =Select(Parent)
            Size: =12
            Text: ="Estacionamiento"
            Width: =261
            X: =99
            Y: =63
            ZIndex: =7

    lbl_estacionamiento_titular As label:
        FontWeight: =FontWeight.Semibold
        Height: =25
        Text: |-
            ="Estacionamiento: "& If(First(Filter(Reservas, var_reserva.Id_Mesa = Id_Mesa, Id_Evento = var_idEvento, Titular = true)).Estacionamiento, "Confirmado", "Sin confirmar")
        Width: =348
        X: =166
        Y: =233
        ZIndex: =19

    lbl_fondo_2 As label:
        Fill: =RGBA(23, 137, 230, 0.7)
        Height: =768
        Text: =""
        Visible: =var_enviarModificacion
        Width: =1366
        ZIndex: =20

    icn_titular As icon.People:
        BorderColor: =RGBA(0, 0, 0, 0)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisplayMode: =DisplayMode.View
        Height: =25
        HoverBorderColor: =
        HoverColor: =
        HoverFill: =
        Icon: =Icon.Diamond
        OnSelect: =
        Visible: =First(Filter(Reservas, var_reserva.Id_Mesa = Id_Mesa, Id_Evento = var_idEvento, Titular = true)).Titular
        Width: =25
        X: =253
        Y: =145
        ZIndex: =21

    th_pup_modificar_reserva As htmlViewer:
        Height: =289
        HtmlText: |-
            ="<div style=""margin: 0px; width: "&(Self.Width-13)&"px; height: "&(Self.Height-13)&"px; background-color: rgba(255,255,255,0.9); box-shadow: 2px 2px 2px 0px rgba(0,0,0,0.2); border-radius:5px""></div>"
        Visible: =var_enviarModificacion
        Width: =727
        X: =365
        Y: =301
        ZIndex: =22

    txt_pup_modificar_reserva As text:
        Default: =""
        Height: =95
        HintText: ="Motivo del cambio"
        Mode: =TextMode.MultiLine
        Visible: =var_enviarModificacion
        Width: =495
        X: =477
        Y: =385
        ZIndex: =23

    btn_pup_enviar As button:
        DisplayMode: |-
            =If(Len(txt_pup_modificar_reserva.Text) = 0,
            DisplayMode.Disabled,
            DisplayMode.Edit)
        OnSelect: |+
            =/*Patch('Solicitudes de Modificacion'; Defaults('Solicitudes de Modificacion');
            {
                Motivo: txt_pup_modificar_reserva.Text;
                Id_Evento: var_idEvento;
                Id_Mesa: var_reserva.Id_Mesa;
                Estado: false
            });;*/
            'SantaBarbara-SolicitudModificacion'.Run(User().Email, txt_pup_modificar_reserva.Text, User().FullName , First(var_Evento).Nombre_Evento, First(Filter(Mesas_1, var_reserva.Id_Mesa = ID)).Numero_Mesa);
            Set(var_enviarModificacion,false);
            Notify("Se envió solicitud de modificación correctamente.", NotificationType.Success);
            Reset(txt_pup_modificar_reserva)
            
        Text: ="Enviar"
        Visible: =var_enviarModificacion
        X: =634
        Y: =520
        ZIndex: =24

    icn_pup_cancelar As icon.Cancel:
        Height: =50
        Icon: =Icon.Cancel
        OnSelect: |-
            =Set(var_enviarModificacion,false);
            Reset(txt_pup_modificar_reserva)
        Visible: =var_enviarModificacion
        Width: =50
        X: =1026
        Y: =310
        ZIndex: =25

    lbl_pup_modificar_reserva As label:
        Align: =Align.Center
        FontWeight: =FontWeight.Bold
        Size: =18
        Text: ="Modificar Reserva"
        Visible: =var_enviarModificacion
        Width: =489
        X: =483
        Y: =324
        ZIndex: =26

    lbl_reservas_no_disponibles As label:
        Align: =Align.Center
        FontWeight: =FontWeight.Bold
        Height: =366
        Size: =20
        Text: ="Las reservas no se encuentran disponibles"
        Visible: |-
            =//IsBlank(var_reserva.Título) && 
            First(var_Evento).Estado.Value <> "Activo" || (Now() > DateAdd(First(var_Evento).Fecha_Finalizacion, 1,TimeUnit.Days)) && (var_reserva.Id_Mesa = 0 || IsBlank(var_reserva))
            //var_reserva.NMesa = 0 && var_reserva.Título <> Blank()
        Width: =1276
        X: =40
        Y: =319
        ZIndex: =27

    lbl_sin_reserva As label:
        Align: =Align.Center
        FontWeight: =FontWeight.Bold
        Height: =120
        Size: =20
        Text: ="Sin reserva"
        Visible: |-
            =//IsBlank(var_reserva.Título)
            var_reserva.Id_Mesa = 0 || IsBlank(var_reserva)
        Width: =634
        X: =682
        Y: =143
        ZIndex: =28

    lbl_cuerpo_1 As label:
        Align: =Align.Center
        Fill: =RGBA(255, 255, 255, 1)
        FontWeight: =FontWeight.Semibold
        Height: =768
        Size: =50
        Text: ="No se encontró el evento, por favor contactá al administrador."
        Visible: |-
            =var_reserva.Mail = Blank() || CountRows(var_Evento) = 0 || 
            (First(var_Evento).Estado.Value <> "Activo" && First(var_Evento).Estado.Value <> "Finalizado") || 
            var_idEvento = 0
            
            // || (Now() > DateAdd(First(var_Evento).Fecha_Finalizacion; 1;TimeUnit.Days))
        Width: =1366
        ZIndex: =29

    img_logo_total_1 As image:
        Height: =250
        Image: ='logo total'
        Visible: |-
            =var_reserva.Mail = Blank() || CountRows(var_Evento) = 0 || 
            (First(var_Evento).Estado.Value <> "Activo" && First(var_Evento).Estado.Value <> "Finalizado") || 
            var_idEvento = 0
            
            // || (Now() > DateAdd(First(var_Evento).Fecha_Finalizacion; 1;TimeUnit.Days))
            // || Now() > First(var_Evento).Fecha_Finalizacion
        Width: =250
        X: =599
        Y: =60
        ZIndex: =30

    lbl_version_app_4 As label:
        Fill: =RGBA(255, 255, 255, 0)
        Height: =32
        Italic: =true
        PaddingLeft: =8
        PaddingRight: =0
        Size: =9
        Text: ="Santa Bárbara - "& varVersionApp
        Width: =166
        Y: =736
        ZIndex: =31

    lbl_control_nv As label:
        Text: |
            =(var_reserva.Id_Mesa = 0) &" "& (Now() < DateAdd(First(var_Evento).Fecha_Finalizacion, 1,TimeUnit.Days)) &" "& (First(var_Evento).Estado.Value = "Activo")
        Visible: =false
        ZIndex: =32

    tm_temporizador_2 As timer:
        AutoStart: =true
        Color: =RGBA(0, 0, 0, 1)
        Duration: =1500
        Fill: =RGBA(56, 96, 178, 0)
        Height: =32
        OnTimerEnd: |-
            =Refresh(Reservas);
            Set(var_idEvento,If(Param("IdEvento")=Blank(), 0,Param("IdEvento")));
            Set(var_Evento,Filter(Eventos,ID=var_idEvento));
            Set(var_reserva,First(Filter(Reservas, Mail = User().Email, Id_Evento = var_idEvento)));
            Set(var_Estacionamiento,If(Param("Estacionamiento")="true","true","false"));
            
            If(var_reserva.Id_Mesa = 0 && (Now() < DateAdd(First(var_Evento).Fecha_Finalizacion, 1,TimeUnit.Days)) && First(var_Evento).Estado.Value = "Activo", Navigate(scr_SeleccionMesa));
            
            Set(var_Mensaje, true)
            
            //Now() < First(var_Evento).Fecha_Finalizacion
        OnTimerStart: |-
            =Set(var_idEvento,If(Param("IdEvento")=Blank(), 0,Param("IdEvento")));
            Set(var_Evento,Filter(Eventos,ID=var_idEvento));
            Set(var_reserva,First(Filter(Reservas, Mail = User().Email, Id_Evento = var_idEvento)));
            Set(var_Estacionamiento,If(Param("Estacionamiento")="true","true","false"));
        Visible: =false
        Width: =88
        X: =1278
        Y: =736
        ZIndex: =33

    Label3 As label:
        Fill: =RGBA(255, 255, 255, 1)
        Height: =768
        Text: =
        Visible: =!var_Mensaje
        Width: =1366
        ZIndex: =34

    "Spinner1 As 'Indicador giratorio'":
        BasePaletteColor: =RGBA(15, 108, 189, 1)
        DisplayMode: =DisplayMode.Edit
        Font: =""
        FontColor: =
        FontItalic: =false
        FontStrikethrough: =false
        FontUnderline: =false
        FontWeight: =""
        Height: =768
        SpinnerSize: ='Spinner.SpinnerSize'.Huge
        Visible: =!var_Mensaje
        Width: =1366
        X: =0
        Y: =0
        ZIndex: =35

